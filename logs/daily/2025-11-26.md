# Research Log: 2025-11-26

## Today's Goal
> Scale up to larger dataset (~256 hours) with MusicGen delay pattern validated from delay ablation

---

## Experiments

### EXP: `20251126_dia_006_musicgen_delay_larger_dataset`
**Status:** ðŸŸ¡ In Progress  
**W&B:** https://wandb.ai/ocamp-university-of-michigan/dia-music-finetuning/runs/l2fzeu4u  
**Hypothesis:** Will get good results with musicgen delay pattern on larger dataset. Good test to see quality it can do with new delay through balancing bass + drums + melody.

**Setup:**
- ~84k samples (~80% tagged)
- 256 hour dataset
- MusicGen delay pattern (validated from dia_004/005 ablation)
- Smaller architecture to account for dataset size
- Sliding window active (though most audio is short anyway)

**Results:**
*(in progress)*

---

## Previous Findings Summary (from delay ablation)

### `20251125_dia_004_delay_ablation`
**Result:** MusicGen delay pattern wins âœ…

| Metric | MusicGen (NEW) | Dia (OLD) | Winner |
|--------|----------------|-----------|--------|
| Train loss @ ~22k steps | 4.24 | 4.41 | NEW (~4% lower) |
| Output entropy | 4.45 | 4.65 | NEW (more confident) |
| Eval loss | 7.91 | 7.72 | OLD (but NEW overfitting harder = expected) |
| Variance | smoother | noisier | NEW |
| Audio quality | smoother, cleaner melody | - | NEW |

**Theory:** Closer together is better. Waiting too long to generate subsequent tokens is not good. Larger gaps force model to reconstruct from distant sequence positions degrading coherence - relevant context is further away, making it harder for model to remember.

---

### `20251125_dia_005_delay_compressed`
**Result:** Worse than both - cut early

**Theory:** Sequential ordering matters. Closer != better - the unique sequential delay per codebook matters more than just minimizing max delay. Having too far proximity hurts, but so does too close proximity. Balance is just sequential proximity.

**Conclusion:** MusicGen delay pattern is the way to go for foreseeable future.

---

## Key Insights
- MusicGen-style delay (0,1,2,3,4,5,6,7,8) outperforms original Dia pattern (0,8,9,10,11,12,13,14,15) for melody-focused data
- Equal codebook weighting benefits high-frequency content (aligns with MusicGen paper findings)
- Sequential proximity matters - not too far, not too close

## Blockers / Questions
- Not sure how much sliding window matters when most audio is short anyway

## Tomorrow's Plan
- Monitor dia_006 results
- Potentially increase dataset if needed

---

## Commits
- `00:02` [`2c520af`] **main**: 20251126_dia_006_musicgen_delay_larger_dataset (13 files)
- `00:17` [`03564ab`] **main**: 20251126_dia_006_musicgen_delay_larger_dataset (5 files)
- `14:53` [`b706c50`] **main**: Requirements.txt (15 files)
- `14:54` [`95d6c02`] **main**: 20251126_dia_007_bottleneck_fix_006ablationA (3 files)
- `14:57` [`b1c48e1`] **main**: Requirements.txt (2 files)
- `14:58` [`71f237a`] **main**: requirements.txt (3 files)
- `15:00` [`7600ee0`] **main**: requirements.txt (4 files)
- `15:15` [`c5e289d`] **main**: Requirements.txt (4 files)
- `15:16` [`277ed2d`] **main**: acc dependency (3 files)
- `15:18` [`5517a43`] **main**: dependencies (3 files)
- `15:19` [`c02cae4`] **main**: dep (3 files)
- `15:22` [`f5e5782`] **main**: dependencies (3 files)
- `15:25` [`fa887b7`] **main**: deps (3 files)
- `15:28` [`1d05223`] **main**: deps (2 files)
- `15:29` [`27ea419`] **main**: deps (3 files)
- `15:31` [`a7c2631`] **main**: deps (3 files)
- `15:36` [`a8293ce`] **main**: deps (3 files)
- `15:58` [`c1e4a97`] **main**: dia_tpu (4 files)
- `16:10` [`1928f8a`] **main**: 20251126_dia_tpu_001_init (7 files)
- `16:22` [`b79d986`] **main**: 20251126_dia_tpu_001_init (3 files)
- `16:44` [`89fe6bb`] **main**: 20251126_dia_tpu_001_init (3 files)
- `17:02` [`6e7d177`] **main**: 20251126_dia_tpu_001_init (3 files)
- `17:06` [`671c169`] **main**: 20251126_dia_tpu_001_init (3 files)
- `17:09` [`f10013a`] **main**: 20251126_dia_tpu_001_init (3 files)
- `17:14` [`68d8624`] **main**: 20251126_dia_tpu_001_init (3 files)
- `17:17` [`1c96ccd`] **main**: 20251126_dia_tpu_001_init (3 files)
- `17:22` [`a61ab13`] **main**: 20251126_dia_tpu_001_init (3 files)
- `17:39` [`0abc25f`] **main**: 20251126_dia_tpu_001_init (3 files)
- `17:44` [`e10a8ab`] **main**: 20251126_dia_tpu_001_init (3 files)
- `17:51` [`9f71e2f`] **main**: 20251126_dia_tpu_001_init (3 files)
- `18:01` [`91d984e`] **main**: 20251126_dia_tpu_001_init (3 files)
- `18:04` [`ba1c554`] **main**: 20251126_dia_tpu_001_init (3 files)
- `18:30` [`99dd7c2`] **main**: 20251126_dia_tpu_001_init (4 files)
- `21:07` [`13cf6ea`] **main**: 20251126_dia_tpu_001_init (3 files)
- `22:14` [`309e1da`] **main**: 20251126_dia_tpu_001_init (6 files)
- `22:24` [`1abe1e4`] **main**: 20251126_dia_tpu_001_init (3 files)
